<!DOCTYPE html>
<html>

	<head>
		<meta name="renderer" content="webkit|ie-comp|ie-stand">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta charset='utf-8'>
		<meta http-equiv="Cache-Control" content="no-siteapp" />
		<title>结算</title>
		<meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
		<meta http-equiv="Cache-Control" content="no-siteapp">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="mobile-web-app-capable" content="yes">
		<meta name="format-detection" content="telephone=no">
		<meta name="keywords" content="">
		<meta name="description" content="">
		<link rel="stylesheet" type="text/css" href="css/base.css" />
		<link rel="stylesheet" type="text/css" href="css/common.css" />
		<script src="js/jquery-1.8.3.min.js" type="text/javascript"></script>
		<script type="text/javascript" src="js/jquery.SuperSlide.2.1.js"></script>
	   <script type="text/javascript" src="js/vue.js"></script>
    <script type="text/javascript" src="js/axios.min.js"></script>
	</head>

	<body>
		<!--header star-->
		<div class="header clearfix">
			
			<div th:insert="index::.toubu"></div>
		</div>
			 
		</div>
		<!--header end-->

		<!--navbar star-->
		<div class="navbar clearfix">
			<div class="content clearfix">
				<ul>
					<li ><a href="index.html">首页</a></li>
					<li><a href="mall.html">商城</a></li>
					<li><a href="special.html">一市一县</a></li>
					<li><a href="area.html">助力地区</a></li>
				</ul>
			</div>
		</div>
		<!--navbar end-->

		<!--Main-wrap-->
		<div class="main-wrap graybg pt40 pb40" id="jie">
			<div class="js-box wrapper white-box">
				<!--收货人信息-->
				<div class="consignee-info">
					<div class="title line-bot"><span class="fs18 pl20 ml40 darkgray">收货人地址</span></div>
					<div class="consignee-box clearfix">
					     
						<div  th:each="a:${user.address}" class="consignee-block check-box radius5" >
							 <div class = "ra">
 	                              <input id="check" type="radio" v-model="check"  name = "check" th:value="${a.addId}" class = "ra"   ></input>   
	                          </div>
 
							<p class="fs14 lh40 clearfix">
								<span class="fl darkgray"><i class="iconfont fs24">&#xe60e;</i> </span>
								<span class="fl darkgray" th:text="${a.addName}">夕雾</span>
							</p>
							<p class="fs14 clearfix lh40">
							    <span class="fl darkgray"><i class="iconfont fs24">&#xe60c;</i></span>
								<span class="fl darkgray" th:text="${a.addPhone}">17378787878</span>
							</p>
								<p class="fs14 clearfix lh40  ">
									<span class="fl darkgray"><i class="fl iconfont fs24">&#xe610;</i>
									<span class="fl address" th:text="${a.addAddr}">湖南省衡阳市珠晖区</span>
								</p>
						
						  
						</div>

						<div class="consignee-block radius5 tc add-info">
							<a href="javascript:" class="full-db alertbox">
								<span class="full-db add pt40"></span>
								<span class="full-db fs14">添加新地址</span>
							</a>
						</div>
					</div>
				</div>
				<!--/end-->


				<!--/end-->
				<!--goodssale-->
				<div class="goodssale">
					<div class="wrapper" th:each="od:${order}">
						<div class="shopping-list pt40 pb40">
							<table class="table_1 table_shopping white-box">
								<tr>
									<th width="40%">商品</th>
									<th width="18%">单价(元)</th>
									<th width="14%">数量</th>
									<th width="14%">小计(元)</th>
									<th width="14%">操作</th>
								</tr>
						<ul >
						  <li th:each="ord:${od.ordertail}">
						  
						<tr   th:each="cl:${ord.product}">
							 <td  >

								<p class="o-goods-info ml20 clearfix pt10 pb10">
									<a href="#" class="fl"><span><img th:src="${cl.pImg}" alt=""></span></a>
									<span class="fl tit mt5 ml10" th:text="${cl.pName}"></span>
								</p>
							</td>
							<td th:text="${cl.price}"></td>
							<td>
								 <p th:text="${ord.dCount}"></p>
							</td>
							<td><span class="orange" th:text="${ord.dTotal}" ></span></td>
							<td>
								<button th:value="${cl.pId}" style="border:none"   th:onclick="javascript:del([[${cl.pId}]],[[${cl.price}]])" ><i class="iconfont fs26">&#xe60b;</i></button>
							</td>
						</tr>
 
						  </li>
						
						</ul>
					</table>
					<div class="shopping-result white-box mt20 clearfix">
						<a href="index" class="fl fs16 pl10">继续购物>></a>
						<p class="fr">
							<button  @click="zhifu()" class="fr orange-but fs20" style="background: #AF1622;border:none">支&nbsp;&nbsp;&nbsp;&nbsp;付</button>
							<span class="fr pr20 fs14 " >总计：<em class="orange fs24" th:if="${od.oTotal}!=null " th:text="'￥'+${od.oTotal}">&nbsp;&nbsp;</em></span>
						</p>
					</div>
						</div>
					</div>
				</div>
				<!--/end-->
             
			</div>
		</div>
		  	<script>
		  	 //使用th:onclick来传参并调用js删除指定pId
        	function del(pId,price){
        			this.pId=pId;
        			this.price=price;
        	 
        			axios.get("delorder?pId="+this.pId+"&price="+this.price).then(res=>{
        				 
        				if(res.data.code==1){
        					window.location.reload();
        				}
        				
        			})
        		}
		  	
		  	   var vue=new Vue({
		  		   el:"#jie",
		  		   data:{
		  			   check:"1",//默认地址
		  			 oid:[[${order.oId}]]
		  		   },
		  		 methods:{
		  	    	 zhifu(){ 
		                 
		                	var addId=this.check;
		                	axios.get("zhifu?addId="+addId+"&oid="+this.oid).then(res=>{
		                		  
		                		if(res.data.code==1){
		                			        alert("支付成功");
		                					window.location.reload();
		                				}else{
		                					 alert("支付shibai");
		                				}
		                	})
		  	       }
		  	  
		  	   }
		  	 })
		  	
		  	</script>
		<!--/end-->

		<!--footer star-->
		<div class="footer clearfix">
			 <div class="weibu" th:include="index::.weibu">
		</div>
		<!--footer end-->

		<div id="mask">
			<div class="alert-box radius8">
				<h3 class="fs20">添加收货地址 <span class="close"></span></h3>
				<div class="address-form box-s">
					<form action="">
						<p class="mb20 clearfix">
							<label class="fl">收货人：</label>
							<input type="text"  value="" placeholder="姓名" class="fl ml5">
							<em class="fl red lh40 ml10">*</em>
						</p>
						<p class="mb20 clearfix">
							<label class="fl">手机：</label>
							<input type="text" value="" placeholder="手机" class="fl ml5">
							<em class="fl red lh40 ml10">*</em>
						</p>
						<p class="mb20 clearfix">
							<label class="fl">地址：</label>
							<select name="" id="" class="fl ml5">
								<option value="0">省份/直辖市</option>
								<option value="1">安徽省</option>
							</select>
							<select name="" id="" class="fl ml5">
								<option value="0">城市</option>
								<option value="1">合肥市</option>
							</select>
							<select name="" id="" class="fl ml5">
								<option value="0">区县</option>
								<option value="1">经开区</option>
							</select>
						</p>
						<p class="mb20 clearfix">
							<label class="fl"></label>
							<input type="text" value="" placeholder="详细地址" class="fl ml5">
							<em class="fl red lh40 ml10">*</em>
						</p>
						<p class="mb20 clearfix">
							<label class="fl">邮政编码：</label>
							<input type="text" placeholder="邮政编码" value="" class="fl ml5">
						</p>
						<p class="mb20 clearfix">
							<label class="fl"></label>
							<input type="button" value="保存" class="fl orange-but radius3 ml5">
							<input type="button" value="取消" class="fl gray-but radius3 ml10">
						</p>
					</form>
				</div>
			</div>
		</div>
	</body>
	<script src="js/other.js" type="text/javascript" ></script>

</html>